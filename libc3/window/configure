#!/bin/sh
## c3
## Copyright 2022,2023 kmx.io <contact@kmx.io>
##
## Permission is hereby granted to use this software granted the above
## copyright notice and this permission paragraph are included in all
## copies and substantial portions of this software.
##
## THIS SOFTWARE IS PROVIDED "AS-IS" WITHOUT ANY GUARANTEE OF
## PURPOSE AND PERFORMANCE. IN NO EVENT WHATSOEVER SHALL THE
## AUTHOR BE CONSIDERED LIABLE FOR THE USE AND PERFORMANCE OF
## THIS SOFTWARE.

set -e

export SRC_TOP="$(dirname "$PWD")"

. ../../config.subr

config_asan
echo "HAVE_ASAN = $HAVE_ASAN" >> ${CONFIG_MK}

if pkg-config cairo; then
    HAVE_CAIRO=true
else
    HAVE_CAIRO=false
fi
echo "HAVE_CAIRO = $HAVE_CAIRO" >> ${CONFIG_MK}

update_config_mk
env_reset

if ${HAVE_CAIRO}; then
    ( cd cairo && ./configure; )
fi
