defmodule List do

  def append = cfn List "list_init_append" (Result, List, Tag)

  def cast = cfn List "list_init_cast" (Result, Sym, Tag)

  def has? = cfn Bool "list_has" (List, Tag, Result)

  def map = fn {
    ([], _) do
      []
    end
    ([a | b], f) do
      [f(a) | map(b, f)]
    end
  }

  def reverse = fn {
    (x) { reverse(x, []) }
    ([], acc) { acc }
    ([a | b], acc) { reverse(b, [a | acc]) }
  }

end
